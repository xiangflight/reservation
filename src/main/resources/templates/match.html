<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8" />
		<title>中意nei的神秘约会</title>
		<meta name="keywords" content="">
		<meta name="description" content="">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=no,email=no,address=no" />
		<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<link rel="stylesheet" href="woa/css/mui.picker.all.css">
		<link rel="stylesheet" href="woa/css/common.css" />
		<link rel="stylesheet" href="woa/css/main.css" />
		<style>
				.redire-checkbox {
				margin: 0 0.86rem;
				text-align: center;
				font-size: 0.28rem;
				position: absolute;
				left: 0;
				right: 0;
				border-radius: 0.1rem;
				background: #FFF;
				top: 20%;
				padding: 0.80rem 0.8rem;
				display: block;
				z-index: 9999;
				height: 2rem;
				box-shadow:0px 2px 21px 0px rgba(255, 255, 255, 0.6);

			}
			.redire-checkbox-span {
				position: relative;
				margin-top: 0.19rem;
				font-size: 0.3rem;
			}
			.tipsBox{
				display: none;
			}
      .tipsBox2{
        display: none;
      }
			
			
		</style>
		<script type="text/javascript" src="woa/js/adaptive.js"></script>
		<script>
			window['adaptive'].desinWidth = 750;
			window['adaptive'].baseFont = 28;
			window['adaptive'].init();
		</script>

	</head>

	<body>

		<div style="background: #000;height: auto;opacity: 0.65;">

			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">年龄范围</span>
				<input placeholder="请选择年龄范围" unselectable="on" onfocus="this.blur()" id="chooseYear" readonly="readonly" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">身高范围</span>
				<input placeholder="请选择身高范围" unselectable="on" onfocus="this.blur()" readonly="readonly" id="talls" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">体重范围</span>
				<input placeholder="请选择体重范围" unselectable="on" onfocus="this.blur()" readonly="readonly" id="chooseWeight" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">学历层次</span>
				<input placeholder="请选择学历" unselectable="on" onfocus="this.blur()" readonly="readonly" id="chooseEducation" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">年收入数</span>
				<input placeholder="请选择年收入" unselectable="on" onfocus="this.blur()" readonly="readonly" id="chooseEarn" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
			<div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">约会时间</span>
				<input placeholder="请选择时间段" unselectable="on" onfocus="this.blur()" readonly="readonly" id="myTime" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
       
        	 <div class="item bdb plr24 flex-sb h100 bw font14">
				<span class="col3">约会区域</span>
				<input placeholder="请选择区域" unselectable="on" onfocus="this.blur()" readonly="readonly" id="chooseArea" class="tae w80 font14" style="text-align: left; text-indent: 0.2rem;color:#777">
				<i class="return_last"></i>
			</div>
       
		</div>

		<div class="w100 tac pos_r top04" style="height: auto;">

			<input type="button" value="开始匹配" class="resh_next" style="color: #333;border-radius: 0.8rem;" />

		</div>

		<div class="w100 h100 pos_r top03"></div>

		<div class="index-box-clear"></div>d
		<div class="index-box-bg-img">
			<img src="woa/img/nei_bg.jpg">
		</div>

		<!--弹窗提示-->
		<div class="redire-checkbox tipsBox">
			<p class="redire-checkbox-span title" style="font-size: 0.32rem;">正在匹配中</p>
			<p class="redire-checkbox-span content" style="font-size: 0.28rem;">请耐心等待匹配结果,结果将以通知的模式发送到给您~</p>
		</div>

    <!--弹窗提示3-->
    <div class="redire-checkbox tipsBox2">
      <p class="redire-checkbox-span" style="font-size: 0.32rem;">为保证诚信约会请预交守约金，守约金可在约会完成后发起退还</p>
      <p class="redire-checkbox-span goPay" style="font-size: 0.28rem;color: orange;top:10px">点击进行前往充值~</p>
    </div>

  </body>
</html>
<script src="woa/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="woa/js/util.js"></script>
<script type="text/javascript" src="woa/js/tooltipbox.js"></script>
<script src="woa/js/user_api.js"></script>
<script src="woa/js/mui.js"></script>
<script src="woa/js/util.js"></script>
<script src="woa/js/mui.min.js"></script>
<script src="woa/js/mui.picker.min.js"></script>
<script src="woa/js/mui.poppicker.js"></script>

<script>

  function getQueryString(name) {
    var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
    var reg_rewrite = new RegExp("(^|/)" + name + "/([^/]*)(/|$)", "i");
    var r = window.location.search.substr(1).match(reg);
    var q = window.location.pathname.substr(1).match(reg_rewrite);
    if (r != null) {
      return unescape(r[2]);
    } else if (q != null) {
      return unescape(q[2]);
    } else {
      return null;
    }
  }
  var openid = getQueryString("openid");
  var matched = getQueryString("matched");
  if (matched == 1) {
    showMask();
    $(".tipsBox").show()
  }
  var money = null;
  userInfo();
  function userInfo() {
    dlc_request('user/info/get',
      {openid: openid},
      function(res) {
        if (res.code == 2000) {
					money = res.data.money;
          var age = res.data.ageif;
          $("#chooseYear").attr("data-id", age);
          switch (age) {
            case 1:
              $("#chooseYear").val("18岁-20岁")
              break;
            case 2:
              $("#chooseYear").val("20岁-23岁")
              break;
            case 3:
              $("#chooseYear").val("23岁-25岁")
              break;
            case 4:
              $("#chooseYear").val("25岁-28岁")
              break;
            case 5:
              $("#chooseYear").val("28岁-30岁")
              break;
            case 6:
              $("#chooseYear").val("30岁-35岁")
              break;
            case 7:
              $("#chooseYear").val("35岁-40岁")
              break;
            default:
              break;
          }
          var height = res.data.heightif;
          $("#talls").attr("data-id", height)
          switch (height) {
            case 1:
              $("#talls").val("140cm-150cm")
              break;
            case 2:
              $("#talls").val("150cm-155cm")
              break;
            case 3:
              $("#talls").val("155cm-160cm")
              break;
            case 4:
              $("#talls").val("160cm-165cm")
              break;
            case 5:
              $("#talls").val("165cm-170cm")
              break;
            case 6:
              $("#talls").val("170cm-175cm")
              break;
            case 7:
              $("#talls").val("175cm-180cm")
              break;
            case 8:
              $("#talls").val("180cm-190cm")
              break;
            case 9:
              $("#talls").val("190cm-200cm")
              break;
            default:
              break;
          }
          var weight = res.data.weightif;
          $("#chooseWeight").attr("data-id", weight)
          switch (weight) {
            case 1:
              $("#chooseWeight").val("40kg-45kg")
              break;
            case 2:
              $("#chooseWeight").val("45kg-50kg")
              break;
            case 3:
              $("#chooseWeight").val("50kg-55kg")
              break;
            case 4:
              $("#chooseWeight").val("55kg-60kg")
              break;
            case 5:
              $("#chooseWeight").val("60kg-70kg")
              break;
            case 6:
              $("#chooseWeight").val("70kg-80kg")
              break;
            case 7:
              $("#chooseWeight").val("80kg-90kg")
              break;
            default:
              break;
          }
          var education = res.data.educationif;
          $("#chooseEducation").attr("data-id", education)
          switch (education) {
            case 1:
              $("#chooseEducation").val("初中及以下")
              break;
            case 2:
              $("#chooseEducation").val("高中")
              break;
            case 3:
              $("#chooseEducation").val("大专")
              break;
            case 4:
              $("#chooseEducation").val("本科")
              break;
            case 5:
              $("#chooseEducation").val("硕士")
              break;
            case 6:
              $("#chooseEducation").val("博士")
              break;
            default:
              break;
          }
          var earn = res.data.earnif;
          $("#chooseEarn").attr("data-id", earn)
          switch (earn) {
            case 1:
              $("#chooseEarn").val("5万元以下")
              break;
            case 2:
              $("#chooseEarn").val("5-10万元")
              break;
            case 3:
              $("#chooseEarn").val("10-15万元")
              break;
            case 4:
              $("#chooseEarn").val("15-20万元")
              break;
            case 5:
              $("#chooseEarn").val("20-25万元")
              break;
            case 6:
              $("#chooseEarn").val("50万元以上")
              break;
            default:
              break;
          }
        } else {
          console.log(res.message)
        }
      }
    )
  }

	//开始匹配
	$(".resh_next").on("click",function(){
    var age = $("#chooseYear").data("id");
    var height = $("#talls").data("id");
    var weight = $("#chooseWeight").data("id");
    var education = $("#chooseEducation").data("id");
    var earn = $("#chooseEarn").data("id");
    var time = $("#myTime").data("id");
    var area = $("#chooseArea").data("id");
    if(isNull(age)) {
      tooltipbox.show("年龄范围未选择")
      return false;
    }
    if(isNull(height)) {
      tooltipbox.show("身高范围未选择")
      return false;
    }
    if(isNull(weight)) {
      tooltipbox.show("体重范围未选择")
      return false;
    }
    if(isNull(education)) {
      tooltipbox.show("学历层次未选择")
      return false;
    }
    if(isNull(earn)) {
      tooltipbox.show("年收入数未选择")
      return false;
    }
    if(isNull(time)) {
      tooltipbox.show("约会时间未选择")
      return false;
    }
    if(isNull(area)) {
      tooltipbox.show("约会区域未选择")
      return false;
    }
    showMask()
    if(isNull(money) || money < 0.01) {
      dlc_request('user/match', {
        openid: openid,
        age: age,
        height: height,
        weight: weight,
        education: education,
        earn: earn,
        time: time,
        area: area,
        save: 1
      }, function(res) {
        console.log(res)
      })
      $(".tipsBox2").show()
      $(".tipsBox2").on("click", function() {
        window.location.href = "/reservation/pocket?openid=" + openid;
      })
    } else {
      $(".tipsBox").show()
      dlc_request('user/match', {
        openid: openid,
        age: age,
        height: height,
        weight: weight,
        education: education,
        earn: earn,
        time: time,
        area: area,
        save: 0
      }, function(res) {
        $(".tipsBox").hide()
        hideMask()
        if(res.code == 2000) {
          var id = res.data.id;
          window.location.href = "/reservation/appointment?id=" + id;
        } else {
          tooltipbox.show("暂无符合条件的另一半!请重新选择条件进行匹配~")
        }
      })
    }
	})

	var picker = new mui.PopPicker();

	$("#chooseYear").on("click", function() {

		picker.setData([{
			value: "1",
			text: "18岁-20岁"
		}, {
			value: "2",
			text: "20岁-23岁"
		}, {
			value: "3",
			text: "23岁-25岁"
		}, {
			value: "4",
			text: "25岁-28岁"
		}, {
      value: "5",
      text: "28岁-30岁"
    }, {
      value: "6",
      text: "30岁-35岁"
    }, {
      value: "4",
      text: "35岁-40岁"
    }
		])

		picker.show(function(SelectedItem) {
			$("#chooseYear").val(SelectedItem[0].text)
      $("#chooseYear").attr("data-id", SelectedItem[0].value)
		})
	})

	//身高
	$("#talls").on("click", function() {
		picker.setData([{
			value: "1",
			text: "140cm-150cm"
		}, {
			value: "2",
			text: "150cm-155cm"
		}, {
      value: "3",
      text: "155cm-160cm"
    }, {
      value: "4",
      text: "160cm-165cm"
    }, {
      value: "5",
      text: "165cm-170cm"
    }, {
      value: "6",
      text: "170cm-175cm"
    }, {
      value: "7",
      text: "175cm-180cm"
    }, {
      value: "8",
      text: "180cm-190cm"
    }, {
      value: "9",
      text: "190cm-200cm"
    }
		])

		picker.show(function(SelectedItem) {
			$("#talls").val(SelectedItem[0].text)
      $("#talls").attr("data-id", SelectedItem[0].value)
		})

	})
	//体重
	$("#chooseWeight").on("click", function() {

		picker.setData([{
			value: "1",
			text: "40kg-45kg"
		}, {
			value: "2",
			text: "45kg-50kg"
		}, {
      value: "3",
      text: "50kg-55kg"
    }, {
      value: "4",
      text: "55kg-60kg"
    }, {
      value: "5",
      text: "60kg-70kg"
    }, {
      value: "6",
      text: "70kg-80kg"
    }, {
      value: "7",
      text: "80kg-90kg"
    }
		])

		picker.show(function(SelectedItem) {
			$("#chooseWeight").val(SelectedItem[0].text)
      $("#chooseWeight").attr("data-id", SelectedItem[0].value)
		})

	})

	//学历
	$("#chooseEducation").on("click", function() {

		picker.setData([{
			value: "1",
			text: "初中及以下"
		}, {
			value: "2",
			text: "高中"
		}, {
			value: "3",
			text: "大专"
		}, {
			value: "4",
			text: "本科"
		}, {
			value: "5",
			text: "硕士"
		}, {
			value: "6",
			text: "博士"
		}])

		picker.show(function(SelectedItem) {
			$("#chooseEducation").val(SelectedItem[0].text)
      $("#chooseEducation").attr("data-id", SelectedItem[0].value)
		})
	})
	//年收入
	$("#chooseEarn").on("click", function() {

		picker.setData([{
			value: "1",
			text: "5万元以下"
		}, {
			value: "2",
			text: "5-10万元"
		}, {
			value: "3",
			text: "10-15万元"
		}, {
			value: "4",
			text: "15-20万元"
		}, {
			value: "5",
			text: "20-25万元"
		}, {
			value: "6",
			text: "50万元以上"
		}])

		picker.show(function(SelectedItem) {
			$("#chooseEarn").val(SelectedItem[0].text)
      $("#chooseEarn").attr("data-id", SelectedItem[0].value)
		})

	})
	//时间段
	$("#myTime").on("click", function() {

		picker.setData([{
      value: "0",
      text: "明天"
    }, {
			value: "1",
			text: "10:00-11:00 AM"
		}, {
			value: "2",
			text: "11:00-12:00 AM"
		}, {
			value: "3",
			text: "12:00-13:00 PM"
		}, {
			value: "4",
			text: "13:00-14:00 PM"
		}, {
			value: "5",
			text: "14:00-15:00 PM"
		}, {
			value: "6",
			text: "15:00-16:00 PM"
		}, {
			value: "7",
			text: "16:00-17:00 PM"
		}, {
			value: "8",
			text: "17:00-18:00 PM"
		}, {
			value: "9",
			text: "18:00-19:00 PM"
		}, {
			value: "10",
			text: "19:00-20:00 PM"
		}, {
			value: "11",
			text: "20:00-21:00 PM"
		}, {
			value: "12",
			text: "21:00-22:00 PM"
		}
		])

		picker.show(function(SelectedItem) {
			$("#myTime").val(SelectedItem[0].text)
      $("#myTime").attr("data-id", SelectedItem[0].value)
		})

	//约会区域
	$("#chooseArea").on("click", function() {

		picker.setData([{
			value: "1",
			text: "南山区"
		}, {
			value: "2",
			text: "福田区"
		}])

		picker.show(function(SelectedItem) {
			$("#chooseArea").val(SelectedItem[0].text)
      $("#chooseArea").attr("data-id", SelectedItem[0].value)
		})

	})




	})
</script>